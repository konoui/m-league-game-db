## 説明
全期間の試合別プレイヤー別リーチ回数上位10件を算出するクエリ

## SQL クエリ
```sql
SELECT 
    ls.start_year AS シーズン年,
    ss.stage AS ステージ,
    g.date AS 試合日,
    g.match_number AS 試合番号,
    p.name AS プレイヤー名,
    t.name AS チーム名,
    COUNT(re.event_id) AS リーチ回数,
    (SELECT COUNT(*) FROM kyoku WHERE game_id = g.id) AS 総局数
FROM game g
JOIN season_stage ss ON g.season_stage_id = ss.id
JOIN league_season ls ON ss.league_season_id = ls.id
JOIN kyoku k ON g.id = k.game_id
JOIN event e ON k.id = e.kyoku_id AND e.type = 'reach'
JOIN reach_event re ON e.id = re.event_id
JOIN player p ON re.actor_player_id = p.id
JOIN player_team pt ON p.id = pt.player_id 
    AND ls.start_year >= pt.joined_season_year 
    AND ls.start_year <= pt.left_season_year
JOIN team t ON pt.team_id = t.id
GROUP BY g.id, p.id, ls.start_year, ss.stage, g.date, g.match_number, p.name, t.name
ORDER BY リーチ回数 DESC, シーズン年 DESC, ステージ, 試合日 DESC, プレイヤー名
LIMIT 10;
```

## 参照テーブル
- game
- season_stage
- league_season
- kyoku
- event
- reach_event
- player
- player_team
- team
